**Docker Compose** – это легкий инструмент для оркестрации контейнеров. Он позволяет описывать взаимодействие контейнеров между собой в одном файле (`docker-compose.yml`) и предоставляет единую точку управления для запуска нескольких контейнеров одновременно.
`Dockerfile` – это инструкция для сборки Docker-образа (image). Он содержит последовательность команд, которые определяют, как будет устроен контейнер.
### **Multistage Building**

Multistage-сборка позволяет значительно уменьшить итоговый размер Docker-образа, так как в финальный образ попадают только необходимые файлы.

Пример использования:
```dockerfile
# Первый этап (build)
FROM golang:1.20 AS builder
WORKDIR /app
COPY . .
RUN go build -o myapp .

# Второй этап (production)
FROM alpine:latest
WORKDIR /app
COPY --from=builder /app/myapp .
CMD ["./myapp"]

```
**Как это работает?**

- Первый этап (`builder`) использует образ `golang:1.20`, компилирует приложение и создает исполняемый файл.
- Второй этап (`production`) берет только необходимый исполняемый файл и запускает его в легковесном `alpine`-образе, что существенно уменьшает итоговый размер.
### **Оптимизация слоев Docker-образа**

Некоторые команды в `Dockerfile` создают дополнительные слои, что увеличивает размер образа. Чтобы избежать этого, можно:

- Объединять несколько команд `RUN`:
```dockerfile
RUN apt-get update && apt-get install -y \
    curl \
    git \
    && rm -rf /var/lib/apt/lists/*

```